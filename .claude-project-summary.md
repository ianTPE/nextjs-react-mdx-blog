# Next.js React MDX Blog Project Summary

## Project Overview

This is a well-structured Next.js blog project leveraging the App Router and MDX for flexible content management. It uses the latest stable versions of all core technologies to ensure optimal performance and development experience.

* **Next.js**: Latest version (15.3.2) with App Router
* **React**: Latest stable release (19.0.0)
* **TypeScript**: Latest stable release
* **MDX**: Latest stable release (3.1.0)
* **Styling**: Tailwind CSS v4
* **Animations**: Framer Motion 12.10.5
* **Data Visualization**: Chart.js, Recharts, Victory

## Content Structure

The project organizes blog content and metadata in a clear, scalable folder layout:

```
/content
  /posts
    /{slug}
      content.mdx
      /components
        index.ts          # Barrel file for exporting components
        CustomChart.tsx
        ...
/content/metadata.ts
```

* **content.mdx**: Primary Markdown + JSX file for each post.
* **components**: Local components specific to a particular post (e.g., custom charts, interactive widgets). These are auto-loaded during MDX rendering.
* **components/index.ts**: Barrel file that exports all local components, enabling cleaner MDX files without imports.
* **metadata.ts**: Centralized metadata file exporting an array or object containing each post's title, date, summary, tags, and other attributes. Used throughout the site for listing, SEO, sitemap generation, and RSS feeds.

### Why Separate Metadata
* **Performance**: Avoid reading full MDX files when only metadata is needed.
* **Tooling Integration**: External tools like sitemap generators or RSS builders can consume metadata directly without parsing MDX.

## Component Architecture

This project supports two categories of MDX components, with a clear override mechanism:

1. **Global Components**
   * Location: `components/mdx/global-components/`
   * Scope: Available to all posts.
   * Usage: Generic elements such as headings, alerts, code blocks, and reusable design system components.

2. **Local Components**
   * Location: `content/posts/[slug]/components/`
   * Scope: Only available within the corresponding post.
   * Usage: Post-specific interactive charts, custom visualizations, or unique content widgets.
   * Best Practice: Use `index.ts` barrel file to export all local components, which allows for cleaner MDX without import statements.

3. **Override Behavior**
   * When a component name exists in both global and local directories, the local component takes precedence.
   * This allows individual posts to customize or extend global behavior without changing the shared component library.

## Client Components in Next.js App Router

With Next.js 15+ and the App Router, all components are **server components** by default. When using interactive components like charts, visualizations, or any components that require client-side JavaScript, you must explicitly mark them as client components:

```typescript
// components/ChartComponent.tsx
"use client";

import React from 'react';
import { Chart } from 'chart.js';
// Rest of the component...
```

### Important Rules for Client Components

1. **Always add "use client" directive** at the top of any component file that:
   * Uses browser-only APIs (window, document, localStorage)
   * Uses React hooks (useState, useEffect, etc.)
   * Renders third-party UI libraries (Chart.js, Framer Motion)
   * Needs interactivity or event handlers

2. **Index.ts barrel files also need "use client"**:
   ```typescript
   // content/posts/[slug]/components/index.ts
   "use client";
   
   import ChartOne from './ChartOne';
   import ChartTwo from './ChartTwo';
   export { ChartOne, ChartTwo };
   ```

3. **Common build errors if missing "use client"**:
   * `Functions cannot be passed directly to Client Components unless you explicitly expose it`
   * `Event handlers cannot be passed to Client Component props`
   * `React hooks can only be used in Client Components`

These rules are especially important for MDX content with visualizations, as the MDX renderer operates in the client context and expects properly marked client components.

## Local Components Best Practices

We use a barrel file approach (`index.ts`) for local components to keep MDX content clean and focused on content rather than technical details:

```typescript
// content/posts/[slug]/components/index.ts
"use client";

import ChartOne from './ChartOne';
import ChartTwo from './ChartTwo';
import CustomTable from './CustomTable';

export {
  ChartOne,
  ChartTwo,
  CustomTable
};
```

This approach provides several benefits:
* **Cleaner MDX Files**: No need for multiple import statements at the top of MDX files
* **Centralized Component Management**: All components are exported from a single location
* **Simplified Refactoring**: Component file names can be changed without updating MDX files
* **Automatic Namespacing**: When MDX is rendered, components are automatically available in the namespace

## MDX Usage Example

### Traditional Approach (with imports):
```mdx
import CustomChart from './components/CustomChart'
import AlertBox from 'components/mdx/global-components/AlertBox'

# Sample Post Title

Here is a post-specific chart:
<CustomChart data={chartData} />

And here is a global alert component:
<AlertBox type="warning">This is a warning message.</AlertBox>
```

### Improved Approach (using index.ts barrel file):
```mdx
# Sample Post Title

Here is a post-specific chart:
<CustomChart data={chartData} />

And here is a global alert component:
<AlertBox type="warning">This is a warning message.</AlertBox>
```

With the barrel file approach, the MDX loader automatically resolves components from the index.ts exports, eliminating the need for explicit imports in the MDX file.

## Rendering Process

* Dynamic routes via `/app/blog/[slug]/page.tsx`
* MDX content is serialized and rendered client-side with `next-mdx-remote`
* Custom components are loaded dynamically using `lib/mdx-loader.ts`
* Global components are merged with local components, with local components taking precedence
* Component resolution prioritizes `index.ts` exports when available
* Components are classified as server or client based on "use client" directives

## Advanced Features

* Code highlighting with Prism
* Support for charts (Chart.js, Recharts, Victory)
* Mermaid diagram support
* Framer Motion animations

## Important Files

- `/app/blog/[slug]/page.tsx` - Main blog post rendering logic
- `/app/blog/[slug]/MDXRenderer.tsx` - Client-side MDX rendering component
- `/lib/mdx.ts` - Core functions for fetching and processing MDX content
- `/lib/mdx-loader.ts` - Handles loading custom components for MDX
- `/content/metadata.ts` - Central storage for all blog post metadata
- `/components/mdx/MDXComponents.tsx` - Global MDX component definitions
- `/components/mdx/global-components/` - Shared MDX components available to all posts
- `/content/posts/[slug]/components/index.ts` - Barrel files for local component exports

## Testing and Deployment

* Run `next build` locally before deploying to catch compilation errors
* Pay special attention to client/server component boundaries
* Common deployment errors are related to:
  * Missing "use client" directives on interactive components
  * Import cycles between server and client components
  * Trying to use browser APIs in server components

## About This Summary File

### Size Limitations & Best Practices

This `.claude-project-summary.md` file doesn't have strict size limits, but consider these practical guidelines:

1. **Context Window Considerations**: Very large files may consume Claude's context window, limiting its ability to process other information.

2. **Processing Efficiency**: Extremely large files take longer to read and process.

3. **Information Density**: Overly verbose summaries can dilute important information.

### Recommendations:

- Ideally keep within 50-100 KB range
- Focus on project structure, key components, and architectural decisions
- Avoid pasting large code blocks; instead, provide file path references
- Organize into clear sections using headings and lists for readability

If you have extensive information to document, consider creating multiple topic-specific summary files (e.g., `.claude-architecture.md`, `.claude-components.md`), then have Claude read specific files as needed for your discussion.
